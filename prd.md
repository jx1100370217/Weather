# 产品需求文档 (PRD) - 项目代号: Aether (天辉)

| 项目名称 | Aether Weather (暂定) |
| :--- | :--- |
| **平台** | iOS (iPhone, 可扩展至 iPad/Watch) |
| **核心理念** | **感知即所得**：用极致的视觉还原真实天气，用精准的数据辅助生活决策。 |
| **开发语言** | Swift (SwiftUI) |
| **数据源建议** | Apple WeatherKit (首选), AerisWeather, OpenWeatherMap |

---

## 1. 产品愿景与定位
*   **愿景**：做App Store里“最想让人打开”的天气应用，即使外面天气不好，App里依然赏心悦目。
*   **目标用户**：
    *   **视觉党**：对UI/UX有极高要求，厌倦了传统表格化天气App的用户。
    *   **户外/通勤人群**：需要分钟级降雨预测、空气质量、穿衣建议的实用主义者。
    *   **极客/数据控**：关注气压、露点、月相、雷达云图的专业用户。

---

## 2. 功能需求列表 (Functional Requirements)

### 2.1 核心天气数据 (The Powerful)
| 优先级 | 功能模块 | 详细描述 |
| :--- | :--- | :--- |
| **P0** | **实时天气** | 温度、体感温度、天气状况（晴/雨/雪）、最高/最低温、风向风速。 |
| **P0** | **分钟级降水** | 未来1小时内的分钟级降雨/雪预测（"15分钟后开始下雨，持续40分钟"）。 |
| **P0** | **24小时预报** | 逐小时温度、降水概率、天气图标滑动查看。 |
| **P0** | **15天趋势** | 未来15天温度曲线图、天气概况。 |
| **P1** | **全能数据面板** | **AQI (空气质量)**、UV指数、湿度、气压、能见度、露点。 |
| **P1** | **日出日落/月相** | 包含黄金时刻 (Golden Hour)、蓝调时刻的可视化图表。 |
| **P1** | **交互式雷达图** | 全球降水、温度、风场热力图层，支持缩放和时间轴播放。 |
| **P2** | **生活指数** | 穿衣建议、洗车指数、过敏/花粉指数、钓鱼/运动适宜度。 |
| **P2** | **多城市管理** | 城市列表页，显示各城市当前时间和天气概览，支持拖拽排序。 |

### 2.2 iOS 专属特性 (The iOS Native)
| 优先级 | 功能模块 | 详细描述 |
| :--- | :--- | :--- |
| **P0** | **桌面小组件 (Widgets)** | 提供小(2x2)、中(2x4)、大(4x4)三种尺寸。支持锁屏小组件 (Lock Screen Widgets)。 |
| **P1** | **灵动岛 (Dynamic Island)** | 仅在有降雨或极端天气时激活，显示倒计时（如：雨停倒计时）。 |
| **P1** | **实时活动 (Live Activities)** | 在锁屏底部实时显示未来1小时降雨进度条，无需解锁即可查看。 |
| **P2** | **触感反馈 (Haptics)** | 配合天气动效（如打雷时手机震动，拨动时间轴时的齿轮感）。 |
| **P2** | **Siri Shortcuts** | 支持语音查询：“Hey Siri，今天适合洗车吗？” |

---

## 3. UI/UX 设计规范 (The Beautiful)

### 3.1 设计理念：沉浸式拟真 (Immersive Realism)
*   **无边界设计**：取消传统的顶栏和底栏，背景全屏铺满。
*   **动态背景**：
    *   **晴天**：阳光不仅是图片，要有光斑（Lens Flare）随手机陀螺仪移动而位移。
    *   **雨天**：雨滴打在屏幕玻璃上的效果，并在UI卡片上产生折射/模糊。
    *   **多云**：云层分层视差滚动（Parallax），有厚重感。
    *   **夜晚**：基于真实星图渲染星空。

### 3.2 卡片与排版
*   **材质**：使用 iOS 风格的 **Frosted Glass (毛玻璃/亚克力)** 效果，高透明度，确保背景可见。
*   **字体**：使用 Apple San Francisco 字体，强调粗细对比（大号细体数字 vs 小号粗体标题）。
*   **层级**：重要信息（温度）极大化，次要信息收纳在卡片中。

### 3.3 动效与交互 (Animations)
*   **启动动画**：App打开时，天气元素（如云朵、太阳）从屏幕边缘优雅入场。
*   **数据可视化**：
    *   风速：不是数字，而是旋转的风扇或流动的粒子。
    *   日出日落：手指滑动抛物线，查看不同时间点的太阳位置。
*   **手势操作**：
    *   下滑刷新。
    *   左右滑动切换城市。
    *   点击卡片展开详情（Hero Animation 转场）。

---

## 4. 技术架构要求 (Technical)

### 4.1 客户端技术栈
*   **语言**：Swift 5+
*   **UI框架**：SwiftUI (必须，为了实现高性能动画和Widget复用)
*   **图形渲染**：Metal 或 SpriteKit (用于处理复杂的粒子降雨、云层渲染，保证60fps流畅度)
*   **数据存储**：CoreData 或 SwiftData (缓存天气数据，实现离线查看)

### 4.2 API 与 后端
*   **Weather Provider**：推荐接入 **Apple WeatherKit**。
    *   *优势*：iOS原生集成，包含未来1小时降水，费用低（每月50万次调用包含在开发者账号内）。
*   **Location**：CoreLocation (需处理权限申请：由“使用期间”引导至“始终允许”以支持小组件更新)。

---

## 5. 性能与非功能需求

*   **加载速度**：冷启动 < 1.5秒，天气数据缓存显示 < 0.2秒（先显示缓存，后台静默更新）。
*   **电量优化**：严格控制定位频率，非前台运行时不进行高精度定位。
*   **深色模式**：完美支持 iOS Dark Mode，并根据日出日落自动切换App内主题色调。
*   **包体大小**：控制在 50MB 以内（尽量使用矢量图和代码生成纹理，减少图片资源）。

---

## 6. 开发路线图 (Roadmap)

### 第一阶段：MVP (最小可行性产品) - *预计周期：4-6周*
*   完成核心天气数据接入 (WeatherKit)。
*   实现基础的动态背景（晴、雨、阴、雪）。
*   完成首页UI布局和城市切换。
*   上线 2x2 和 2x4 桌面小组件。

### 第二阶段：视觉与交互升级 - *预计周期：3-4周*
*   引入 SpriteKit 粒子系统（逼真的雨雪效果）。
*   加入体感震动 (Haptics)。
*   开发雷达地图功能。
*   适配灵动岛。

### 第三阶段：增值与完善 - *预计周期：3-4周*
*   开发 Watch OS 独立应用。
*   增加生活指数通知推送。
*   **Pro版内购**：解锁更多天气源、解锁全部雷达历史数据、自定义App图标。

---

## 7. 差异化竞争策略 (你的App如何胜出？)

1.  **情感化文案**：不要只显示“小雨”，要显示“带把伞吧，别淋湿了”。
2.  **声音景观 (Soundscape)**：(可选功能) 打开App时，播放极其微弱的环境音（如下雨时的白噪音），增加沉浸感。
3.  **极简模式**：双击屏幕隐藏所有UI，只留背景和时间温度，变成一个精美的床头时钟。

---

### 给开发者的特别提示 (开发者视角)
*   **关于UI库**：不要使用通用的图表库，建议用 SwiftUI 的 `Charts` 框架或者手写 `Path` 来绘制温度曲线，这样才能做出符合App调性的平滑曲线。
*   **关于动画**：使用 `.matchedGeometryEffect` 来做卡片展开和收起的丝滑过渡。

